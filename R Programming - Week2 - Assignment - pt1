# Write a function named ‘pollutantmean’ that calculates the mean of a 
#pollutant (sulfate or nitrate) across a specified list of monitors. 
#The function ‘pollutantmean’ takes three arguments: 
#‘directory’, ‘pollutant’, and ‘id’. Given a vector monitor 
#ID numbers, ‘pollutantmean’ reads that monitors’ particulate matter data
#from the directory specified in the ‘directory’ argument and returns the 
#mean of the pollutant across all of the monitors, ignoring any missing 
#values coded as NA.

pollutantmean <- function(directory = getwd(), pollutant, index = 1:332){
    library(plyr)
    temp = list.files(path = directory, pattern= ".csv")
    dat_csv = ldply(temp, read.csv)
    dat_clean <- dat_csv[complete.cases(dat_csv),]
    dat_use <- subset(dat_clean, ID %in% index)
    
    if (pollutant == "nitrate"){
        mean_of_pollutant <- mean(dat_use[["nitrate"]])
        print("Mean of nitrate is:") 
        mean_of_pollutant
    }
    
    else if(pollutant == "sulfate"){
        mean_of_pollutant <- mean(dat_use[["sulfate"]])
        print("Mean of sulfate is:") 
        mean_of_pollutant
    }
}

pollutantmean("C:/Users/igorp/Documents/Courses/DataScience Course - Coursera/R Programming - Course 2/rprog_data_specdata/specdata",pollutant = "sulfate", index = 18:19)

> pollutantmean("C:/Users/igorp/Documents/Courses/DataScience Course - Coursera/R Programming - Course 2/rprog_data_specdata/specdata",pollutant = "sulfate", index = 18:19)
[1] "Mean of sulfate is:"
[1] 1.045613
